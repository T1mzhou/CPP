# 38.逻辑操作符的陷阱



![Slide1](38.逻辑操作符的陷阱.assets/Slide1.PNG)



![Slide2](38.逻辑操作符的陷阱.assets/Slide2.PNG)



![Slide3](38.逻辑操作符的陷阱.assets/Slide3.PNG)

```cpp
#include <iostream>
#include <string>

using namespace std;

int func(int i)
{
    cout << "int func(int i) : i = " << i << endl;
    
    return i;
}

int main()
{
    if( func(0) && func(1) ) //0->false 非0->true->false
    {
        cout << "Result is true!" << endl;
    }
    else
    {
        cout << "Result is false!" << endl;
    }
    
    cout << endl;
    
    if( func(0) || func(1) ) //true
    {
        cout << "Result is true!" << endl;
    }
    else
    {
        cout << "Result is false!" << endl;
    }
    
    return 0;
}

```

![Slide4](38.逻辑操作符的陷阱.assets/Slide4.PNG)



![Slide5](38.逻辑操作符的陷阱.assets/Slide5.PNG)

```cpp
#include <iostream>
#include <string>

using namespace std;

class Test
{
    int mValue;
public:
    Test(int v)
    {
        mValue = v;
    }
    int value() const
    {
        return mValue;
    }
};

bool operator && (const Test& l, const Test& r)
{
    return l.value() && r.value();
}

bool operator || (const Test& l, const Test& r)
{
    return l.value() || r.value();
}

Test func(Test i)
{
    cout << "Test func(Test i) : i.value() = " << i.value() << endl;
    
    return i;
}

int main()
{
    Test t0(0);
    Test t1(1);
    
    if( func(t0) && func(t1) )// 调用2次func--》= (operator && (func(t0), func(t1)))
    {
        cout << "Result is true!" << endl;
    }
    else
    {
        cout << "Result is false!" << endl;
    }
    
    cout << endl;
    
    if( func(1) || func(0) ) // 调用2次func func(1)->true， func(0)->false变得从右往左运算
    {                        // (operator || (func(t0), func(t1)))
        cout << "Result is true!" << endl;
    }
    else
    {
        cout << "Result is false!" << endl;
    }
    
    return 0;
}

```

![Slide6](38.逻辑操作符的陷阱.assets/Slide6.PNG)



![Slide7](38.逻辑操作符的陷阱.assets/Slide7.PNG)

**违背了原生的语义-》不推荐重载**

![Slide9](38.逻辑操作符的陷阱.assets/Slide9.PNG)



![Slide8](38.逻辑操作符的陷阱.assets/Slide8.PNG)